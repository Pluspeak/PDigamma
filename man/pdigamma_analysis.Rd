% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.R
\name{pdigamma_analysis}
\alias{pdigamma_analysis}
\title{Complete PDigamma Analysis Pipeline}
\usage{
pdigamma_analysis(
  formula_alpha = ~1,
  formula_delta = ~1,
  formula_rho = ~1,
  data,
  y_var = NULL,
  delta_min = 1.05,
  rho_min = 0.05,
  alpha_level = 0.05,
  B = 1000,
  max_iter,
  conf_level = 0.95,
  verbose = TRUE,
  save_intermediate = FALSE
)
}
\arguments{
\item{formula_alpha}{Formula for alpha (proximal shape), e.g., alpha ~ x1 + x2
Use ~ 1 for intercept-only. Response variable ignored (extracted from data).}

\item{formula_delta}{Formula for delta (tail index), e.g., delta ~ z1 + z2}

\item{formula_rho}{Formula for rho (coupling ratio), e.g., rho ~ w1 + w2}

\item{data}{Data frame containing all variables}

\item{y_var}{Name of response variable in data (default: first variable in formula_alpha)}

\item{delta_min}{Hard boundary for delta (default: 1.05)}

\item{rho_min}{Hard boundary for rho (default: 0.05)}

\item{alpha_level}{Significance level for model selection (default: 0.05)}

\item{B}{Bootstrap replications (default: 1000)}

\item{max_iter}{Maximum number of iterations.}

\item{conf_level}{Confidence level (default: 0.95)}

\item{verbose}{Print progress (default: TRUE)}

\item{save_intermediate}{Save intermediate fits (default: FALSE)}
}
\value{
Comprehensive results object of class "pdigamma_analysis" containing:
  \item{data_info}{Summary of input data}
  \item{stage0}{Pre-diagnosis results}
  \item{stage1}{Initialization results}
  \item{stage2}{EM fitting results (full model)}
  \item{stage3}{Model selection results}
  \item{stage4}{Final inference results}
  \item{final_model}{Final selected model object}
}
\description{
One-function interface for full analysis: from raw data to final inference.
Implements Algorithm 3.4 (Stages 0-4).
}
\details{
Stage 0: Pre-diagnosis and model pre-selection (pre_diagnosis)
  Stage 1: Three-tier initialization (initialize_params)
  Stage 2: EM algorithm fitting (fit_em)
  Stage 3: Model selection via boundary LRT (model_selection)
  Stage 4: Risk measures with adaptive bootstrap (run_inference)
}
\examples{
\dontrun{
# Basic usage with formulas
result <- pdigamma_analysis(
  formula_alpha = ~ x1 + x2,      # alpha ~ x1 + x2
  formula_delta = ~ z1,            # delta ~ z1 (tail heterogeneity)
  formula_rho = ~ 1,               # common rho
  data = mydata,
  y_var = "claim_count"
)

# Intercept-only for all parameters (homogeneous model)
result <- pdigamma_analysis(~ 1, ~ 1, ~ 1, data = mydata, y_var = "y")
}
}
\references{
Algorithm 3.4 (Complete), Section 3.6
}
\seealso{
pdigamma_fit (lower-level interface)
}
