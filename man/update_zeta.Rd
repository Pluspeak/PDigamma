% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/2_em_core.R
\name{update_zeta}
\alias{update_zeta}
\title{M-Step Block (c): Update Zeta (Rho/Coupling Ratio Parameters)}
\usage{
update_zeta(y, W, v_vec, zeta_old, alpha_vec, delta_vec, rho_min = 0.05)
}
\arguments{
\item{y}{Vector of observed counts}

\item{W}{Design matrix for rho}

\item{v_vec}{Conditional expectations E[log V_i | Y_i] from E-step}

\item{zeta_old}{Previous zeta values}

\item{alpha_vec}{Current alpha values (fixed)}

\item{delta_vec}{Current delta values (updated in previous block)}

\item{rho_min}{Minimum rho for hard boundary (default: 0.05)}
}
\value{
Updated zeta vector
}
\description{
Maximizes Q-function for rho using L-BFGS-B.
Only active for Model A (full heterogeneity).
}
\details{
Q_zeta = sum_i [ -delta_i/(1+rho_i) * log(y_i) + gamma_i * v_vec[i] 
                  - log Gamma(gamma_i) ]
  where gamma_i = rho_i * delta_i / (1 + rho_i)
  
  With rho_i = exp(W_i' zeta)
}
\seealso{
E_step, update_beta, update_xi
}
