% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/4_inference.R
\name{adaptive_bootstrap}
\alias{adaptive_bootstrap}
\title{Adaptive M-out-of-N Bootstrap (Algorithm 3.3)}
\usage{
adaptive_bootstrap(
  y,
  X,
  Z,
  W,
  fit_final,
  model_type,
  risk_measure_fn = NULL,
  B = 1000,
  conf_level = 0.95,
  verbose = TRUE
)
}
\arguments{
\item{y}{Original response vector}

\item{X}{Design matrix for alpha}

\item{Z}{Design matrix for delta}

\item{W}{Design matrix for rho}

\item{fit_final}{Final fitted model from model_selection}

\item{model_type}{Final model type ("A" or "C")}

\item{risk_measure_fn}{Function to compute risk measure from fitted model (see examples)}

\item{B}{Number of bootstrap replications (default: 1000)}

\item{conf_level}{Confidence level (default: 0.95)}

\item{verbose}{Print progress (default: TRUE)}
}
\value{
List containing:
  \item{point_estimate}{Point estimate from original data}
  \item{ci_percentile}{Percentile bootstrap CI}
  \item{ci_bca}{BCa CI (if delta > 2)}
  \item{bootstrap_estimates}{All B bootstrap estimates}
  \item{subsample_sizes}{Adaptive m for each observation (if observation-specific)}
}
\description{
Computes confidence intervals for risk measures using adaptive subsample size
based on estimated tail index. Essential for valid inference when delta <= 2.
}
\details{
Adaptive exponent: tau_i = 0.7 + 0.3 * min(1, delta_i - 1)
  Subsample size: m_i = floor(n^tau_i)
  
  For delta > 2: standard bootstrap valid, use BCa or percentile
  For 1 < delta <= 2: m-out-of-n bootstrap required, use percentile only
}
\references{
Algorithm 3.3, Table 2.4 (Bootstrap Validity), Section 3.5.3
}
\seealso{
compute_risk_measures, sibuya_remedy
}
