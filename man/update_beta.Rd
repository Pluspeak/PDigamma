% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/2_em_core.R
\name{update_beta}
\alias{update_beta}
\title{M-Step Block (a): Update Beta (Alpha/Proximal Shape Parameters)}
\usage{
update_beta(y, X, u_vec, beta_old, alpha_min = 0.01, maxit = 50, tol = 1e-06)
}
\arguments{
\item{y}{Vector of observed counts (not directly used, but kept for interface)}

\item{X}{Design matrix for alpha}

\item{u_vec}{Conditional expectations E[U_i | Y_i] from E-step}

\item{beta_old}{Previous beta values}

\item{alpha_min}{Minimum alpha for stability (default: 0.01)}

\item{maxit}{Maximum IRLS iterations (default: 50)}

\item{tol}{Convergence tolerance (default: 1e-6)}
}
\value{
Updated beta vector
}
\description{
Maximizes Q-function for alpha using IRLS (Iteratively Reweighted Least Squares).
}
\details{
Q_beta = sum_i [ (alpha_i - 1) * E[log U_i | Y_i] - alpha_i - log Gamma(alpha_i) + ... ]
  Using u_vec as proxy for E[log U | Y] (since E[U] relates to exp(E[log U]) for Gamma)
  
  Actually: for U ~ Gamma(alpha, 1), E[log U] = psi(alpha)
  So we match psi(alpha_i) to log(u_vec[i]) approximately
  
  This becomes a Gamma GLM with log link: alpha_i = exp(X_i' beta)
  Response: "working" variable derived from u_vec
}
\seealso{
E_step, update_xi, update_zeta
}
