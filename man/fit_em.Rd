% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/2_em_core.R
\name{fit_em}
\alias{fit_em}
\title{Main EM Algorithm for PDigamma Regression (Algorithm 3.1)}
\usage{
fit_em(
  y,
  X = NULL,
  Z = NULL,
  W = NULL,
  theta_init,
  model_type = "A",
  delta_min = 1.05,
  rho_min = 0.05,
  max_iter = 1000,
  tol = 1e-06,
  verbose = TRUE
)
}
\arguments{
\item{y}{Vector of observed counts (positive integers)}

\item{X}{Design matrix for alpha (NULL for intercept-only)}

\item{Z}{Design matrix for delta (NULL for intercept-only)}

\item{W}{Design matrix for rho (NULL for intercept-only)}

\item{theta_init}{Initial parameter values from initialize_params}

\item{model_type}{Model type: "A", "B", "C", or "D"}

\item{delta_min}{Hard boundary for delta (default: 1.05)}

\item{rho_min}{Hard boundary for rho (default: 0.05)}

\item{max_iter}{Maximum EM iterations (default: 1000)}

\item{tol}{Convergence tolerance (default: 1e-6)}

\item{verbose}{Print progress (default: TRUE)}
}
\value{
List containing:
  \item{coefficients}{Named list with beta, xi, zeta estimates}
  \item{theta_list}{Individual parameters (alpha_vec, delta_vec, rho_vec)}
  \item{loglik}{Final log-likelihood}
  \item{iterations}{Number of EM iterations}
  \item{converged}{Logical, TRUE if converged}
  \item{history}{Iteration history (if verbose)}
}
\description{
Fits PDigamma regression model using EM algorithm with hard boundary projection.
}
\references{
Algorithm 3.1, Theorem 3.2 (Convergence)
}
\seealso{
initialize_params, E_step, M_step
}
