% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/2_em_core.R
\name{update_xi}
\alias{update_xi}
\title{M-Step Block (b): Update Xi (Delta/Tail Index Parameters)}
\usage{
update_xi(y, Z, v_vec, xi_old, alpha_vec, rho_vec, delta_min = 1.05)
}
\arguments{
\item{y}{Vector of observed counts}

\item{Z}{Design matrix for delta}

\item{v_vec}{Conditional expectations E[log V_i | Y_i] from E-step}

\item{xi_old}{Previous xi values}

\item{alpha_vec}{Current alpha values (fixed in this block)}

\item{rho_vec}{Current rho values (fixed in this block)}

\item{delta_min}{Minimum delta for hard boundary (default: 1.05)}
}
\value{
Updated xi vector
}
\description{
Maximizes Q-function for delta using L-BFGS-B with convexity guarantee.
}
\details{
Q_xi = sum_i [ -delta_i/(1+rho_i) * log(y_i) - rho_i*delta_i/(1+rho_i) * v_vec[i] 
                 - log C(alpha_i, delta_i, rho_i) ]
  
  With delta_i = 1 + exp(Z_i' xi), this is strictly convex in xi (Proposition 3.2)
}
\references{
Proposition 3.2 (Convexity of Tail Index Subproblem)
}
\seealso{
E_step, update_beta, update_zeta
}
