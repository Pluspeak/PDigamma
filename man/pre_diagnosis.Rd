% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/0_data_prep.R
\name{pre_diagnosis}
\alias{pre_diagnosis}
\title{Pre-Diagnosis and Model Pre-Selection (Stage 0)}
\usage{
pre_diagnosis(y, X = NULL, Z = NULL, W = NULL, delta_min = 1.05)
}
\arguments{
\item{y}{Vector of observed counts (positive integers)}

\item{X}{Design matrix for alpha (can be NULL for intercept-only)}

\item{Z}{Design matrix for delta (can be NULL for intercept-only)}

\item{W}{Design matrix for rho (can be NULL for intercept-only)}

\item{delta_min}{Minimum delta threshold for Sibuya warning (default: 1.05)}
}
\value{
List containing:
  \item{model_type}{Selected model: "A" (full), "B" (tail-focused), "C" (Generalized Zeta), or "D" (proximal-tail separation)}
  \item{sibuya_warning}{Logical, TRUE if data suggests infinite mean (delta close to 1)}
  \item{xi_hill}{Global Hill estimate of tail index}
  \item{delta_global}{Initial global delta estimate}
  \item{covariate_richness}{Data frame with p and n for each parameter}
}
\description{
Performs preliminary diagnostics on data and selects initial model type.
Detects Sibuya boundary cases and determines appropriate model complexity.
}
\details{
Selection rules:
  - If xi_hill > 10 (delta < 1.1): Sibuya warning, select Model B
  - If total covariates p < 5: select Model B (parsimonious)
  - Otherwise: select Model A (full heterogeneity)
}
\references{
Algorithm 3.4 (Stage 0), Section 3.6
}
\seealso{
initialize_params, fit_em
}
