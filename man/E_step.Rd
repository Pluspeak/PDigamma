% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/2_em_core.R
\name{E_step}
\alias{E_step}
\title{E-Step: Conditional Expectation of Latent Variables (Proposition 3.1)}
\usage{
E_step(y, alpha_vec, delta_vec, rho_vec)
}
\arguments{
\item{y}{Vector of observed counts (positive integers)}

\item{alpha_vec}{Vector of individual alpha parameters}

\item{delta_vec}{Vector of individual delta parameters}

\item{rho_vec}{Vector of individual rho parameters}
}
\value{
List containing:
  \item{u_vec}{E[U_i | Y_i] for each observation}
  \item{v_vec}{E[log V_i | Y_i] for each observation}
  \item{aux_info}{Additional diagnostics (optional)}
}
\description{
Computes E[U_i | Y_i] and E[log V_i | Y_i] for each observation given current parameters.
These are the sufficient statistics needed for M-step.
}
\details{
From Proposition 3.1 and latent variable representation (Proposition 2.2):
  - U_i | Y_i, V_i ~ Gamma(alpha_i + Y_i, 1 + V_i^(-1/eta_i))
  - V_i | Y_i has complex marginal; we use approximation via digamma functions
  
  Key formulas:
  u_i = (alpha_i + y_i) / (1 + E[V_i^(-1/eta_i) | Y_i])
  E[log V_i | Y_i] involves psi(gamma_i) - psi(alpha_i + gamma_i) + ...
}
\references{
Proposition 3.1, Section 3.3.2
}
\seealso{
M_step, fit_em
}
